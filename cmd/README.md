# How to run the system

1. type **make tools** to install the necessary tools, such as Goose and sqlc

Note: Goose is used to manage sql migration (including the creation of database tables),
sqlc is used to generate sql queries and database related code automatically.
the code generated by sqlc is put under resources/database/sqlc/internal

2. type **make up_build** to build the application and run docker-compose.yml to load all
   the dependencies
   Note: If local application has not any change, just skip this step and go to the next step

3. type **make migrateup** to create database tables.

4. type **make copy_data** to copy sample data to playlist-postgres container.
   When psql command prompt shows, type "\i copy_data_to_postgres.sql"

5. Open postman, and try to test the micro-service
   Get, http://localhost, return a welcome message
   Get, http://localhost/playlists, return all the playlists from the sample data
   Get, http://localhost/playlists/{id}, return one playlist with the specified id.
   Get, http://localhost/playlists/category/{categoryCode}, return one playlist with the specified
   category code.
   Post http://localhost/playlist/new, pass the JSON file as body (Not finish yet)

6. type **make down** to stop the system.

# Other usage:

## Generate Data

type **make generate_data** to generate a new batch of sample data, which will override the
original sample data.

## Use sqlc

Any database queries could be generated automatically by using sqlc. Steps:
a. Go to the folder resources/database/sqlc
b. change anything in the query.sql about CRUD operation
c. type sqlc generate
Content will be generated within internal sub directory. Copy what you need to
your .go files and make any changes necessary

## Note

after updating to the colima,
volume of the postgresql is not supported, so
remove the following two lines from the docker-compose.yml

    volumes:
      - ./db-data/postgres/:/var/lib/postgresql/data/
